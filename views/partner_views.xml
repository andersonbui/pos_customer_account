<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <record id="view_partner_property_form" model="ir.ui.view">
            <field name="name">res.partner.pos.form.inherit</field>
            <field name="model">res.partner</field>
            <field name="inherit_id" ref="base.view_partner_form"/>
            <field name="arch" type="xml">
                <div name="button_box" position="inside">
                    <button class="oe_stat_button" type="action" name="%(action_account_move_line_form)d"
                        context="{'search_default_partner_id': active_id,'default_partner_id': active_id}"
                        attrs="{'invisible': [('customer', '=', False)]}"
                        icon="fa-usd">
                        <div class="o_form_field o_stat_info">
                            <span class="o_stat_value">
                                <field name="account_balance" widget='monetary' options="{'currency_field': 'currency_id'}"/>
                            </span>
                            <span class="o_stat_text">Balance</span>
                        </div>
                    </button>
                </div>
            </field>
        </record>

        <record id="view_customer_account_tree" model="ir.ui.view">
            <field name="name">res.partner.tree.account</field>
            <field name="model">res.partner</field>
            <field eval="8" name="priority"/>
            <field name="arch" type="xml">
                <tree string="Customers" decoration-danger="account_balance&lt;0" decoration-success="account_balance&gt;0">
                    <field name="display_name" string="Name"/>
                    <field name="phone"/>
                    <field name="email"/>
                    <field name="account_balance" widget='monetary' options="{'currency_field': 'currency_id'}"/>
                    <field name="currency_id" invisible="1"/>
                    <field name="user_id" invisible="1"/>
                    <button type="action" name="%(action_account_move_line_form)d"
                        context="{'search_default_partner_id': id,'default_partner_id': id}" string="View History"/>
                    <button type="action" name="%(action_customer_account_apply_credit_form)d"
                        context="{'active_partner_id': id}" string="Apply Credit"/>
                    <button type="action" name="%(action_customer_account_apply_debit_form)d"
                        context="{'active_partner_id': id}" string="Apply Debit"/>
                </tree>
            </field>
        </record>


        <record id="action_partner_customer_account_form" model="ir.actions.act_window">
              <field name="name">Customers</field>
              <field name="type">ir.actions.act_window</field>
              <field name="res_model">res.partner</field>
              <field name="view_type">form</field>
              <field name="view_mode">tree,form</field>
              <field name="domain">[]</field>
              <field name="context">{'default_customer':1, 'search_default_customer':1, 'default_company_type': 'company','default_is_company': 1}</field>
              <field name="filter" eval="True"/>
          </record>
          <record id="action_customer_account_form_view1" model="ir.actions.act_window.view">
              <field eval="1" name="sequence"/>
              <field name="view_mode">tree</field>
              <field name="view_id" ref="view_customer_account_tree"/>
              <field name="act_window_id" ref="action_partner_customer_account_form"/>
          </record>
          <record id="action_partner_customer_form_view3" model="ir.actions.act_window.view">
              <field eval="2" name="sequence"/>
              <field name="view_mode">form</field>
              <field name="view_id" ref="base.view_partner_form"/>
              <field name="act_window_id" ref="action_partner_customer_account_form"/>
          </record>

          <menuitem id="menu_point_customers"
              name="Customers"
              parent="point_of_sale.menu_point_root"
              sequence="50"/>

          <menuitem id="menu_customer_account" name="Customers"
              action="action_partner_customer_account_form"
              parent="menu_point_customers" sequence="1"/>
      </data>
  </odoo>
